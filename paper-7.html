<script>
// 宏观量子力学论文双语化脚本 (段落对位版)
document.addEventListener('DOMContentLoaded', function() {
    // ========== 第1步：添加统一的翻译样式 ==========
    const style = document.createElement('style');
    style.textContent = `
        .mqm-translation {
            color: #666;
            font-style: italic;
            margin-top: 5px;
            font-size: 0.95em;
            clear: both;
        }
        .mqm-translation::before {
            content: "EN: ";
            font-weight: bold;
            color: #3498db;
        }
        .mqm-subtitle {
            display: block;
            font-size: 0.75em;
            color: #7f8c8d;
            margin-top: 3px;
            font-style: normal;
        }
    `;
    document.head.appendChild(style);
    
    // ========== 第2步：核心翻译词典 ==========
    // 这是通用词典，您需要在下方为每篇论文添加其专有内容
    const dict = {
        // === 通用术语 (已在首页使用) ===
        '宏观量子力学': 'Macroscopic Quantum Mechanics',
        '核心发现': 'Core Discovery',
        '理论总览': 'Overview of the Theory',
        '论文系列': 'Paper Series',
        '返回首页': 'Return to Home',
        '宏观量子力学研究': 'Macroscopic Quantum Mechanics Research',
        '袁立 与 智教授 共同构建': 'Co-established by Yuan Li and Professor Zhi',
        '月球是宏观引力子吗？': 'Is the Moon a Macroscopic Graviton?',
        '忠于牛顿': 'Staying True to Newton',
        'CW-S-T-E 自然单位制': 'The CW-S-T-E Natural Unit System',
        '宏观量子态的建立': 'Establishment of Macroscopic Quantum States',
        '引力量子化假设': 'The Gravitational Quantization Hypothesis',
        '慧-智常数与第五对称性': 'The Hui-Zhi Constant and the Fifth Symmetry',
        '与广义相对论的统一': 'Unification with General Relativity',
        '范式革命': 'A Paradigm Revolution',
        '月球作为宏观引力子': 'The Moon as a Macroscopic Graviton',
        '发现月球轨道角动量量子化 L = nħ, n ≈ 2.75×10⁶⁸': 'Discovery of Lunar Orbital Angular Momentum Quantization L = nħ, n ≈ 2.75×10⁶⁸',
        '重塑万有引力定律及其与相对论的调和': 'Reformulating the Law of Universal Gravitation and its Reconciliation with Relativity',
        '解决宏观量子力学的"维度悖论"': 'Resolving the "Dimensional Paradox" of Macroscopic Quantum Mechanics',
        '定义宏观本征态与叠加态': 'Defining Macroscopic Eigenstates and Superposition States',
        '提出核心动力学定律 F<sub>G</sub> = n·F₀': 'Proposing the Core Dynamical Law F<sub>G</sub> = n·F₀',
        '发现深层数学结构 κ<sub>HZ</sub> = (2πα<sub>G</sub>)/√n': 'Discovery of the Deep Mathematical Structure κ<sub>HZ</sub> = (2πα<sub>G</sub>)/√n',
        '实现实质性统一': 'Achieving Substantive Unification',
        '宣告从"量子微观"到"量子普适"的转变': 'Announcing the Shift from "Quantum Microscopic" to "Quantum Universal"',
        '宏观量子力学的奠基 - 主论文': 'The Foundation of Macroscopic Quantum Mechanics - Main Paper',
        
        // === 请在此处添加当前论文的独有句子 ===
        // 例如，对于 paper-1.html，您需要添加：
        // '论文1特有的中文长句...': 'The full English translation of that sentence...',
        // 直接从论文HTML里复制中文句子过来作为key
    };
    
    // ========== 第3步：智能翻译函数 ==========
    function translateParagraph(text) {
        // 1. 优先匹配完整句子
        if (dict[text]) {
            return dict[text];
        }
        // 2. 如果没找到完整匹配，可以保留原样或返回空（后续手动添加）
        console.log('未找到翻译:', text);
        return ''; // 返回空字符串，则不创建翻译段落
    }
    
    // ========== 第4步：处理页面内容 ==========
    // A. 处理所有段落 <p> （不包括已经包含翻译的段落）
    document.querySelectorAll('p:not(:has(.mqm-translation))').forEach(p => {
        const originalText = p.textContent.trim();
        if (originalText && !p.classList.contains('translation')) { // 排除可能已有的旧翻译
            const translatedText = translateParagraph(originalText);
            if (translatedText) {
                const translationElem = document.createElement('p');
                translationElem.className = 'mqm-translation';
                translationElem.innerHTML = translatedText;
                p.insertAdjacentElement('afterend', translationElem);
            }
        }
    });
    
    // B. 处理主标题 <h1>（添加副标题）
    const mainTitle = document.querySelector('h1');
    if (mainTitle && !mainTitle.querySelector('.mqm-subtitle')) {
        const titleText = mainTitle.textContent.trim();
        if (dict[titleText]) {
            const subtitle = document.createElement('span');
            subtitle.className = 'mqm-subtitle';
            subtitle.textContent = dict[titleText];
            mainTitle.appendChild(subtitle);
        }
    }
    
    // C. 处理次级标题 <h2>, <h3>（可选）
    document.querySelectorAll('h2, h3').forEach(heading => {
        const headingText = heading.textContent.trim();
        if (dict[headingText] && !heading.querySelector('.mqm-subtitle')) {
            const subtitle = document.createElement('span');
            subtitle.className = 'mqm-subtitle';
            subtitle.textContent = dict[headingText];
            heading.appendChild(subtitle);
        }
    });
    
    console.log('MQM 双语化处理完成。');
});
</script>
